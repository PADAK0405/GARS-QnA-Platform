# 관리자 설정 가이드

## 첫 번째 관리자 지정하기

### 1단계: 사용자 등록 확인
먼저 관리자로 지정할 사용자가 Google 로그인을 통해 시스템에 등록되어 있는지 확인합니다.

```bash
# 사용자 목록 확인
node scripts/list-users.js
```

### 2단계: 관리자 권한 부여

#### 방법 1: 스크립트 사용 (권장)
```bash
# 일반 관리자로 지정
node scripts/make-admin.js your-email@example.com admin

# 최고 관리자로 지정
node scripts/make-admin.js your-email@example.com super_admin

# 모더레이터로 지정
node scripts/make-admin.js your-email@example.com moderator
```

#### 방법 2: 데이터베이스 직접 수정
```sql
-- MySQL 접속
mysql -u root -p

-- 데이터베이스 선택
USE qna_hub;

-- 사용자 확인
SELECT id, display_name, email, role FROM users WHERE email = 'your-email@example.com';

-- 관리자 권한 부여
UPDATE users SET role = 'admin' WHERE email = 'your-email@example.com';
```

### 3단계: 관리자 대시보드 접근
1. 관리자 권한이 부여된 계정으로 로그인
2. 네비게이션에 "관리자" 메뉴가 표시되는지 확인
3. `/admin.html` 페이지로 이동하여 관리자 대시보드 확인

## 🔐 관리자 권한 레벨

### 일반 사용자 (user)
- 기본 질문/답변 작성 권한
- 자신의 글 수정/삭제 권한

### 모더레이터 (moderator)
- 일반 사용자 권한 +
- 콘텐츠 숨기기/복원 권한
- 질문/답변 관리 권한

### 관리자 (admin)
- 모더레이터 권한 +
- 사용자 상태 관리 (정지/차단/복원)
- 사용자 역할 변경
- 관리 로그 확인

### 최고 관리자 (super_admin)
- 모든 권한
- 시스템 전체 관리

## 🛠️ 관리자 도구

### 스크립트 도구들

#### 1. 사용자 목록 확인
```bash
node scripts/list-users.js
```

#### 2. 관리자 권한 부여
```bash
node scripts/make-admin.js <email> <role>
```

#### 3. 데이터베이스 초기화
```bash
node scripts/init-db.js
```

### 웹 관리자 도구

#### 관리자 대시보드 (`/admin.html`)
- 사용자 관리
- 콘텐츠 관리
- 통계 확인
- 관리 로그 확인

## 📋 관리 작업 예시

### 1. 새 관리자 지정
```bash
# 이메일로 관리자 지정
node scripts/make-admin.js newadmin@example.com admin
```

### 2. 사용자 정지
1. 관리자 대시보드 → 사용자 관리 탭
2. 정지할 사용자 찾기
3. "정지" 버튼 클릭
4. 정지 기간과 사유 입력

### 3. 부적절한 콘텐츠 숨기기
1. 질문/답변에서 "숨기기" 버튼 클릭
2. 숨기는 사유 입력
3. 즉시 해당 콘텐츠가 숨겨짐

### 4. 사용자 복원
1. 관리자 대시보드 → 사용자 관리 탭
2. 정지/차단된 사용자 찾기
3. "복원" 버튼 클릭

## 🔍 문제 해결

### 관리자 메뉴가 보이지 않을 때
1. 사용자 역할 확인: `node scripts/list-users.js`
2. 역할이 올바르게 설정되었는지 확인
3. 브라우저 새로고침 또는 재로그인

### 관리자 권한이 작동하지 않을 때
1. 데이터베이스 연결 확인
2. 사용자 상태가 'active'인지 확인
3. 서버 로그 확인

### 권한 오류 발생 시
1. 관리자 로그 확인 (`/admin.html` → 관리 로그 탭)
2. 사용자 상태 및 역할 재확인
3. 필요시 데이터베이스 직접 수정

## 📊 모니터링

### 관리자 활동 모니터링
- 관리자 대시보드의 "관리 로그" 탭에서 모든 관리 작업 확인
- 로그에는 관리자, 작업 유형, 대상, 사유, 시간이 기록됨

### 사용자 활동 모니터링
- 사용자 목록에서 상태 및 역할 확인
- 정지/차단된 사용자 모니터링
- 새로운 사용자 등록 추적

## 🚨 보안 주의사항

1. **관리자 계정 보안**
   - 강력한 비밀번호 사용
   - 정기적인 비밀번호 변경
   - 관리자 권한을 신뢰할 수 있는 사용자에게만 부여

2. **관리 작업 기록**
   - 모든 관리 작업은 자동으로 로그에 기록됨
   - 정기적으로 로그 검토

3. **권한 관리**
   - 필요한 최소 권한만 부여
   - 불필요한 관리자 권한은 정기적으로 검토 및 회수

## 📞 지원

관리자 설정에 문제가 있을 경우:
1. 로그 파일 확인
2. 데이터베이스 상태 확인
3. 스크립트 실행 결과 확인
