# ğŸ—ï¸ Q&A Hub ì•„í‚¤í…ì²˜ ì„¤ê³„

## ğŸ“Š ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        í´ë¼ì´ì–¸íŠ¸                             â”‚
â”‚  (ë¸Œë¼ìš°ì € - Chrome, Safari, Firefox ë“±)                     â”‚
â”‚  â€¢ index.html (ì§ˆë¬¸ ëª©ë¡)                                     â”‚
â”‚  â€¢ ask.html (ì§ˆë¬¸ ì‘ì„±)                                       â”‚
â”‚  â€¢ ranking.html (ë­í‚¹)                                        â”‚
â”‚  â€¢ script.js (í´ë¼ì´ì–¸íŠ¸ ë¡œì§)                                â”‚
â”‚  â€¢ style.css (ìŠ¤íƒ€ì¼)                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ HTTPS
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Nginx (ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ)                      â”‚
â”‚  â€¢ SSL/TLS ì¢…ë£Œ                                              â”‚
â”‚  â€¢ ì •ì  íŒŒì¼ ì„œë¹™                                             â”‚
â”‚  â€¢ ë¡œë“œ ë°¸ëŸ°ì‹±                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Express.js ì• í”Œë¦¬ì¼€ì´ì…˜ (PM2)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ server.js (ë©”ì¸ ì„œë²„)                                 â”‚   â”‚
â”‚  â”‚  â€¢ ë¼ìš°íŒ…                                            â”‚   â”‚
â”‚  â”‚  â€¢ ì¸ì¦ (Passport.js)                                â”‚   â”‚
â”‚  â”‚  â€¢ ì„¸ì…˜ ê´€ë¦¬                                          â”‚   â”‚
â”‚  â”‚  â€¢ API ì—”ë“œí¬ì¸íŠ¸                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ database/                                            â”‚   â”‚
â”‚  â”‚  â€¢ connection.js (ì—°ê²° í’€)                           â”‚   â”‚
â”‚  â”‚  â€¢ queries.js (ì¿¼ë¦¬ ë¡œì§)                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                 â”‚
         â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Google OAuth â”‚   â”‚   MySQL (RDS)    â”‚
â”‚   Provider   â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚              â”‚   â”‚  â”‚ users       â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚ questions   â”‚ â”‚
                   â”‚  â”‚ answers     â”‚ â”‚
                   â”‚  â”‚ images      â”‚ â”‚
                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### ERD (Entity Relationship Diagram)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      users       â”‚         â”‚    questions     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”‚ id (PK)          â”‚
â”‚ display_name     â”‚         â”‚ user_id (FK)     â”‚
â”‚ email            â”‚         â”‚ title            â”‚
â”‚ score            â”‚         â”‚ content          â”‚
â”‚ created_at       â”‚         â”‚ created_at       â”‚
â”‚ updated_at       â”‚         â”‚ updated_at       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²                            â”‚
         â”‚                            â–¼
         â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚     answers      â”‚
         â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚                   â”‚ id (PK)          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ question_id (FK) â”‚
                             â”‚ user_id (FK)     â”‚
                             â”‚ content          â”‚
                             â”‚ created_at       â”‚
                             â”‚ updated_at       â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚     images       â”‚
                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                             â”‚ id (PK)          â”‚
                             â”‚ url              â”‚
                             â”‚ entity_type      â”‚
                             â”‚ entity_id (FK)   â”‚
                             â”‚ created_at       â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í…Œì´ë¸” ìƒì„¸

#### `users` - ì‚¬ìš©ì ì •ë³´
- **PK**: `id` (VARCHAR(255), Google ID)
- **ì¸ë±ìŠ¤**: `score DESC`, `created_at DESC`
- **íŠ¹ì§•**: Google OAuth í”„ë¡œí•„ ì •ë³´ ì €ì¥

#### `questions` - ì§ˆë¬¸
- **PK**: `id` (AUTO_INCREMENT)
- **FK**: `user_id â†’ users.id`
- **ì¸ë±ìŠ¤**: `user_id`, `created_at DESC`
- **Full-text ì¸ë±ìŠ¤**: `title, content` (ê²€ìƒ‰ ê¸°ëŠ¥)

#### `answers` - ë‹µë³€
- **PK**: `id` (AUTO_INCREMENT)
- **FK**: 
  - `question_id â†’ questions.id`
  - `user_id â†’ users.id`
- **ì¸ë±ìŠ¤**: `question_id`, `user_id`, `created_at DESC`

#### `images` - ì´ë¯¸ì§€
- **PK**: `id` (AUTO_INCREMENT)
- **ê´€ê³„**: Polymorphic (question ë˜ëŠ” answer)
- **ì¸ë±ìŠ¤**: `(entity_type, entity_id)`

## ğŸ”„ ìš”ì²­ íë¦„

### 1. ì‚¬ìš©ì ë¡œê·¸ì¸
```
í´ë¼ì´ì–¸íŠ¸ â†’ /auth/google
    â†“
Google OAuth ì¸ì¦
    â†“
/auth/google/callback
    â†“
Passport.js ì²˜ë¦¬
    â†“
Database.findOrCreateUser()
    â†“
ì„¸ì…˜ ìƒì„±
    â†“
ë©”ì¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜
```

### 2. ì§ˆë¬¸ ìƒì„±
```
í´ë¼ì´ì–¸íŠ¸ â†’ POST /api/questions
    â†“
ì¸ì¦ í™•ì¸ (req.user)
    â†“
ì´ë¯¸ì§€ ì—…ë¡œë“œ (ì„ íƒ)
    â†“
Database.createQuestion()
    â”œâ”€ BEGIN TRANSACTION
    â”œâ”€ INSERT question
    â”œâ”€ INSERT images (if any)
    â””â”€ COMMIT
    â†“
ì‘ë‹µ (201 Created)
```

### 3. ë‹µë³€ ìƒì„±
```
í´ë¼ì´ì–¸íŠ¸ â†’ POST /api/questions/:id/answers
    â†“
ì¸ì¦ í™•ì¸
    â†“
ì§ˆë¬¸ ì¡´ì¬ í™•ì¸
    â†“
Database.createAnswer()
    â”œâ”€ BEGIN TRANSACTION
    â”œâ”€ INSERT answer
    â”œâ”€ INSERT images (if any)
    â”œâ”€ UPDATE users SET score += 10
    â””â”€ COMMIT
    â†“
ì‘ë‹µ (201 Created)
```

## âš¡ ì„±ëŠ¥ ìµœì í™”

### 1. Connection Pooling
```javascript
{
    connectionLimit: 10,      // ìµœëŒ€ 10ê°œ ì—°ê²° ì¬ì‚¬ìš©
    queueLimit: 0,            // ë¬´ì œí•œ ëŒ€ê¸°ì—´
    waitForConnections: true, // ì—°ê²° ëŒ€ê¸°
    enableKeepAlive: true     // ì—°ê²° ìœ ì§€
}
```

**ì¥ì **:
- ì—°ê²° ìƒì„±/ì¢…ë£Œ ì˜¤ë²„í—¤ë“œ ì œê±°
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì œì–´
- ë™ì‹œ ìš”ì²­ ì²˜ë¦¬ ëŠ¥ë ¥ í–¥ìƒ

### 2. ë³‘ë ¬ ì¿¼ë¦¬ ì‹¤í–‰
```javascript
// ì§ˆë¬¸, ë‹µë³€, ì´ë¯¸ì§€ë¥¼ ë³‘ë ¬ë¡œ ì¡°íšŒ
const [answers, images] = await Promise.all([
    getAnswers(questionId),
    getImages(questionId)
]);
```

**ì„±ëŠ¥ í–¥ìƒ**: 3ê°œ ìˆœì°¨ ì¿¼ë¦¬ â†’ ë³‘ë ¬ ì‹¤í–‰ìœ¼ë¡œ **2~3ë°° ë¹ ë¦„**

### 3. ì¸ë±ì‹± ì „ëµ
- **Primary Key**: AUTO_INCREMENTë¡œ ë¹ ë¥¸ ì‚½ì…
- **Foreign Key**: JOIN ì„±ëŠ¥ í–¥ìƒ
- **Compound Index**: `(entity_type, entity_id)`
- **Full-text Index**: ê²€ìƒ‰ ê¸°ëŠ¥ (í–¥í›„ í™•ì¥)

### 4. íŠ¸ëœì­ì…˜
```javascript
BEGIN TRANSACTION
  INSERT question
  INSERT images
COMMIT
```

**ë°ì´í„° ë¬´ê²°ì„±**: ì§ˆë¬¸ê³¼ ì´ë¯¸ì§€ê°€ ì›ìì ìœ¼ë¡œ ì €ì¥

## ğŸ”’ ë³´ì•ˆ ì•„í‚¤í…ì²˜

### 1. ì¸ì¦ & ì¸ê°€
- **OAuth 2.0**: Google ì‹ ë¢° ê¸°ë°˜ ì¸ì¦
- **ì„¸ì…˜**: HttpOnly, Secure ì¿ í‚¤
- **CSRF**: SameSite ì¿ í‚¤ ì„¤ì •

### 2. SQL Injection ë°©ì§€
```javascript
// âŒ ì·¨ì•½í•œ ì½”ë“œ
db.query(`SELECT * FROM users WHERE id = ${userId}`);

// âœ… ì•ˆì „í•œ ì½”ë“œ (Prepared Statement)
db.execute('SELECT * FROM users WHERE id = ?', [userId]);
```

### 3. XSS ë°©ì§€
```javascript
function escapeHtml(text) {
    return text.replace(/[&<>"']/g, m => map[m]);
}
```

### 4. íŒŒì¼ ì—…ë¡œë“œ ë³´ì•ˆ
- **íŒŒì¼ íƒ€ì… ê²€ì¦**: MIME type + í™•ì¥ì
- **íŒŒì¼ í¬ê¸° ì œí•œ**: 5MB
- **íŒŒì¼ëª… ë¬´ì‘ìœ„í™”**: timestamp + random

## ğŸ“ˆ í™•ì¥ì„± ê³ ë ¤ì‚¬í•­

### ìˆ˜í‰ í™•ì¥ (Horizontal Scaling)
```
Load Balancer
    â”œâ”€ EC2 Instance 1
    â”œâ”€ EC2 Instance 2
    â””â”€ EC2 Instance 3
         â†“
    RDS Read Replica
```

### ìºì‹± ì „ëµ (Redis ì¶”ê°€ ì‹œ)
```javascript
// ë­í‚¹ ìºì‹± (5ë¶„)
const rankings = await cache.get('rankings') 
    || await Database.getTopRankings();
```

### CDN (CloudFront)
- ì •ì  íŒŒì¼ (CSS, JS, ì´ë¯¸ì§€)
- ì „ ì„¸ê³„ ì—£ì§€ ë¡œì¼€ì´ì…˜ ë°°í¬

### ë°ì´í„°ë² ì´ìŠ¤ ìƒ¤ë”©
```
Users 0-100K   â†’ Shard 1
Users 100K-200K â†’ Shard 2
Users 200K+     â†’ Shard 3
```

## ğŸ”§ ìœ ì§€ë³´ìˆ˜ì„±

### ëª¨ë“ˆí™” êµ¬ì¡°
```
server.js          # ë¼ìš°íŒ…, ë¯¸ë“¤ì›¨ì–´
database/
  connection.js    # ì—°ê²° ê´€ë¦¬
  queries.js       # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
```

### í™˜ê²½ ë³€ìˆ˜ ë¶„ë¦¬
- ê°œë°œ: `.env`
- í”„ë¡œë•ì…˜: AWS Secrets Manager

### ë¡œê¹… ì „ëµ
```javascript
console.log('âœ… ì„±ê³µ')
console.error('âŒ ì˜¤ë¥˜:', error)
```

í”„ë¡œë•ì…˜: Winston ë˜ëŠ” CloudWatch Logs

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ì§€í‘œ

### í•µì‹¬ ì§€í‘œ
- **ì‘ë‹µ ì‹œê°„**: < 200ms (ëª©í‘œ)
- **ì—ëŸ¬ìœ¨**: < 0.1%
- **ê°€ìš©ì„±**: 99.9%
- **ë™ì‹œ ì ‘ì†**: 100+ users

### ëª¨ë‹ˆí„°ë§ ë„êµ¬
- **PM2**: í”„ë¡œì„¸ìŠ¤ ëª¨ë‹ˆí„°ë§
- **AWS CloudWatch**: ì„œë²„ ë©”íŠ¸ë¦­
- **RDS Performance Insights**: DB ì„±ëŠ¥

## ğŸš€ ë°°í¬ íŒŒì´í”„ë¼ì¸

```
Git Push
    â†“
GitHub Actions (CI/CD)
    â”œâ”€ Lint ê²€ì‚¬
    â”œâ”€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
    â””â”€ ë¹Œë“œ
    â†“
AWS CodeDeploy
    â†“
EC2 Instance
    â”œâ”€ git pull
    â”œâ”€ npm install
    â”œâ”€ pm2 restart
    â””â”€ health check
```

## ğŸ’° ë¹„ìš© ìµœì í™”

### AWS í”„ë¦¬ í‹°ì–´
- EC2 t2.micro: 750ì‹œê°„/ì›”
- RDS db.t3.micro: 750ì‹œê°„/ì›”
- ìŠ¤í† ë¦¬ì§€: 30GB
- ë°ì´í„° ì „ì†¡: 15GB/ì›”

### ì˜ˆìƒ ë¹„ìš© (í”„ë¦¬ í‹°ì–´ ì´í›„)
- EC2 t2.micro: $10/ì›”
- RDS db.t3.micro: $15/ì›”
- ì´í•©: **$25/ì›”**

### ë¹„ìš© ì ˆê° íŒ
- Reserved Instances (1ë…„ ì•½ì •)
- Auto Scaling (íŠ¸ë˜í”½ì— ë”°ë¼)
- S3 Lifecycle ì •ì±… (ì˜¤ë˜ëœ ì´ë¯¸ì§€ ì‚­ì œ)

